<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="color-scheme" content="light dark" />
  <title>tree-sitter-ts-highlight â€” Interactive Demo</title>
  <script type="importmap">
  {
    "imports": {
      "tree-sitter-ts": "./runtime/tree-sitter-ts-proxy.js",
      "tree-sitter-ts-highlight": "./runtime/tree-sitter-ts-highlight-proxy.js"
    }
  }
  </script>
  <style>
    * {
      box-sizing: border-box;
    }

    :root {
      --bg: #f6f7fb;
      --surface: #ffffff;
      --text: #1c2430;
      --muted: #607085;
      --border: #d9e0ea;
      --input-bg: #ffffff;
      --primary: #3b82f6;
      --primary-text: #ffffff;
      --mono-bg: #f8fafc;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #0f0f14;
        --surface: #141422;
        --text: #e6e6e6;
        --muted: #9aa0aa;
        --border: #2a2a3a;
        --input-bg: #0f1020;
        --primary: #7aa2f7;
        --primary-text: #101420;
        --mono-bg: #0f1020;
      }
    }

    body {
      margin: 0;
      padding: 0 20px 80px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
    }

    .container {
      max-width: 1080px;
      margin: 0 auto;
    }

    h1 {
      margin: 40px 0 8px;
      font-size: 2rem;
    }

    .subtitle {
      color: var(--muted);
      margin-bottom: 16px;
    }

    .hero {
      display: flex;
      justify-content: space-between;
      align-items: end;
      gap: 12px;
      margin-bottom: 8px;
      flex-wrap: wrap;
    }

    .hero a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 600;
      font-size: 0.92rem;
    }

    .hero a:hover {
      text-decoration: underline;
    }

    .tab-nav {
      display: flex;
      gap: 8px;
      margin: 0 0 16px;
      flex-wrap: wrap;
    }

    .tab-btn {
      border: 1px solid var(--border);
      border-radius: 999px;
      background: var(--surface);
      color: var(--text);
      padding: 8px 14px;
      font-size: 0.9rem;
      cursor: pointer;
    }

    .tab-btn.active {
      background: var(--primary);
      color: var(--primary-text);
      border-color: var(--primary);
    }

    .view {
      display: none;
    }

    .view.active {
      display: block;
    }

    .panel {
      border: 1px solid var(--border);
      border-radius: 10px;
      background: var(--surface);
      padding: 16px;
      margin-bottom: 16px;
    }

    .controls {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 12px;
      align-items: end;
    }

    label {
      font-size: 0.82rem;
      color: var(--muted);
      display: block;
      margin-bottom: 6px;
    }

    select,
    textarea,
    button,
    input[type="checkbox"] {
      font: inherit;
    }

    select,
    textarea {
      width: 100%;
      background: var(--input-bg);
      border: 1px solid var(--border);
      color: var(--text);
      border-radius: 8px;
      padding: 10px;
    }

    textarea {
      min-height: 200px;
      resize: vertical;
      font-family: 'SF Mono', Menlo, monospace;
      font-size: 13px;
    }

    button {
      background: var(--primary);
      border: none;
      color: var(--primary-text);
      border-radius: 8px;
      padding: 10px 14px;
      font-weight: 600;
      cursor: pointer;
    }

    .row {
      display: flex;
      gap: 18px;
      align-items: center;
      flex-wrap: wrap;
    }

    .check {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--text);
    }

    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    @media (max-width: 860px) {
      .grid-2 {
        grid-template-columns: 1fr;
      }
    }

    .grid-3 {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 12px;
    }

    @media (max-width: 860px) {
      .grid-3 {
        grid-template-columns: 1fr;
      }
    }

    .code-wrap pre {
      margin: 0;
      border-radius: 8px;
      overflow-x: auto;
      padding: 8px;
      font-size: 13px;
      line-height: 1.5;
      font-family: 'SF Mono', Menlo, monospace;
    }

    h2 {
      margin: 0 0 10px;
      font-size: 1.15rem;
    }

    .muted {
      color: var(--muted);
      font-size: 0.92rem;
    }

    ul {
      margin: 8px 0 0 18px;
    }

    .symbols-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    .symbols-table th,
    .symbols-table td {
      text-align: left;
      padding: 8px 10px;
      border-bottom: 1px solid var(--border);
      font-family: 'SF Mono', Menlo, monospace;
      font-size: 12px;
    }

    .symbols-table th {
      color: var(--primary);
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.04em;
    }

    .small {
      font-size: 0.8rem;
      color: var(--muted);
    }

    .diff-preview {
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: auto;
    }

    .json-preview {
      margin: 0;
      padding: 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--mono-bg);
      font-family: 'SF Mono', Menlo, monospace;
      font-size: 12px;
      max-height: 280px;
      overflow: auto;
      white-space: pre;
    }

    .hlts-symbol-fold-toggle:hover {
      opacity: 1 !important;
    }

    /* tree-sitter-ts-highlight - Default Light Theme (One Light-inspired) */
    .hlts.hlts-default-light {
      background: #fafafa;
      color: #383a42;
      font-family: 'SF Mono', 'Fira Code', 'Fira Mono', 'Roboto Mono', Menlo, Courier, monospace;
      font-size: 14px;
      line-height: 1.5;
      tab-size: 4;
      overflow-x: auto;
      padding: 16px;
      border-radius: 6px;
    }

    /* Token categories */
    .hlts-default-light .hlts-keyword {
      color: #a626a4;
      font-weight: bold;
    }

    .hlts-default-light .hlts-identifier {
      color: #383a42;
    }

    .hlts-default-light .hlts-string {
      color: #50a14f;
    }

    .hlts-default-light .hlts-number {
      color: #986801;
    }

    .hlts-default-light .hlts-comment {
      color: #a0a1a7;
      font-style: italic;
    }

    .hlts-default-light .hlts-operator {
      color: #383a42;
    }

    .hlts-default-light .hlts-punctuation {
      color: #383a42;
    }

    .hlts-default-light .hlts-type {
      color: #c18401;
    }

    .hlts-default-light .hlts-decorator {
      color: #a626a4;
    }

    .hlts-default-light .hlts-tag {
      color: #e45649;
    }

    .hlts-default-light .hlts-attribute {
      color: #986801;
    }

    .hlts-default-light .hlts-meta {
      color: #a0a1a7;
    }

    .hlts-default-light .hlts-regexp {
      color: #50a14f;
    }

    .hlts-default-light .hlts-escape {
      color: #986801;
      font-weight: bold;
    }

    .hlts-default-light .hlts-variable {
      color: #e45649;
    }

    .hlts-default-light .hlts-constant {
      color: #986801;
    }

    .hlts-default-light .hlts-error {
      color: #e45649;
      text-decoration: wavy underline;
    }

    .hlts-default-light .hlts-plain {
      color: #383a42;
    }

    /* Line numbers (table layout) */
    .hlts-default-light .hlts-table {
      border-collapse: collapse;
      width: 100%;
    }

    .hlts-default-light .hlts-line-number {
      color: #a0a1a7;
      border-right: 1px solid #e0e0e0;
      padding-right: 12px;
      padding-left: 8px;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-default-light .hlts-line-content {
      padding-left: 16px;
      white-space: pre;
    }

    .hlts-default-light .hlts-table tr:hover {
      background: rgba(0, 0, 0, 0.03);
    }

    /* Decoration utility classes */
    .hlts-default-light .hlts-error-underline {
      text-decoration: wavy underline #e45649;
      text-underline-offset: 2px;
    }

    .hlts-default-light .hlts-highlight-line {
      background: rgba(255, 255, 0, 0.1);
    }

    /* Diff views */
    .hlts-default-light .hlts-diff {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
    }

    .hlts-default-light .hlts-diff-header .hlts-diff-label {
      text-align: left;
      font-weight: 600;
      padding: 6px 10px;
      border-bottom: 1px solid #e0e0e0;
    }

    .hlts-default-light .hlts-diff-gutter {
      color: #a0a1a7;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      padding: 0 10px;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-default-light .hlts-diff-content {
      white-space: pre;
      padding: 0 10px;
      vertical-align: top;
    }

    .hlts-default-light .hlts-diff-row.hlts-diff-context {
      background: transparent;
    }

    .hlts-default-light .hlts-diff-row.hlts-diff-added {
      background: rgba(46, 160, 67, 0.12);
    }

    .hlts-default-light .hlts-diff-row.hlts-diff-removed {
      background: rgba(207, 34, 46, 0.12);
    }

    .hlts-default-light .hlts-diff-row.hlts-diff-modified {
      background: rgba(191, 135, 0, 0.12);
    }

    .hlts-default-light .hlts-diff-sign {
      width: 24px;
      text-align: center;
      color: #6a737d;
      user-select: none;
      -webkit-user-select: none;
    }

    /* tree-sitter-ts-highlight - Default Dark Theme (One Dark-inspired) */
    .hlts.hlts-default-dark {
      background: #282c34;
      color: #abb2bf;
      font-family: 'SF Mono', 'Fira Code', 'Fira Mono', 'Roboto Mono', Menlo, Courier, monospace;
      font-size: 14px;
      line-height: 1.5;
      tab-size: 4;
      overflow-x: auto;
      padding: 16px;
      border-radius: 6px;
    }

    /* Token categories */
    .hlts-default-dark .hlts-keyword {
      color: #c678dd;
      font-weight: bold;
    }

    .hlts-default-dark .hlts-identifier {
      color: #abb2bf;
    }

    .hlts-default-dark .hlts-string {
      color: #98c379;
    }

    .hlts-default-dark .hlts-number {
      color: #d19a66;
    }

    .hlts-default-dark .hlts-comment {
      color: #5c6370;
      font-style: italic;
    }

    .hlts-default-dark .hlts-operator {
      color: #abb2bf;
    }

    .hlts-default-dark .hlts-punctuation {
      color: #abb2bf;
    }

    .hlts-default-dark .hlts-type {
      color: #e5c07b;
    }

    .hlts-default-dark .hlts-decorator {
      color: #c678dd;
    }

    .hlts-default-dark .hlts-tag {
      color: #e06c75;
    }

    .hlts-default-dark .hlts-attribute {
      color: #d19a66;
    }

    .hlts-default-dark .hlts-meta {
      color: #5c6370;
    }

    .hlts-default-dark .hlts-regexp {
      color: #98c379;
    }

    .hlts-default-dark .hlts-escape {
      color: #d19a66;
      font-weight: bold;
    }

    .hlts-default-dark .hlts-variable {
      color: #e06c75;
    }

    .hlts-default-dark .hlts-constant {
      color: #d19a66;
    }

    .hlts-default-dark .hlts-error {
      color: #e06c75;
      text-decoration: wavy underline;
    }

    .hlts-default-dark .hlts-plain {
      color: #abb2bf;
    }

    /* Line numbers (table layout) */
    .hlts-default-dark .hlts-table {
      border-collapse: collapse;
      width: 100%;
    }

    .hlts-default-dark .hlts-line-number {
      color: #636d83;
      border-right: 1px solid #3b4048;
      padding-right: 12px;
      padding-left: 8px;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-default-dark .hlts-line-content {
      padding-left: 16px;
      white-space: pre;
    }

    .hlts-default-dark .hlts-table tr:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    /* Decoration utility classes */
    .hlts-default-dark .hlts-error-underline {
      text-decoration: wavy underline #e06c75;
      text-underline-offset: 2px;
    }

    .hlts-default-dark .hlts-highlight-line {
      background: rgba(255, 255, 0, 0.05);
    }

    /* Diff views */
    .hlts-default-dark .hlts-diff {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
    }

    .hlts-default-dark .hlts-diff-header .hlts-diff-label {
      text-align: left;
      font-weight: 600;
      padding: 6px 10px;
      border-bottom: 1px solid #3b4048;
    }

    .hlts-default-dark .hlts-diff-gutter {
      color: #636d83;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      padding: 0 10px;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-default-dark .hlts-diff-content {
      white-space: pre;
      padding: 0 10px;
      vertical-align: top;
    }

    .hlts-default-dark .hlts-diff-row.hlts-diff-context {
      background: transparent;
    }

    .hlts-default-dark .hlts-diff-row.hlts-diff-added {
      background: rgba(46, 160, 67, 0.18);
    }

    .hlts-default-dark .hlts-diff-row.hlts-diff-removed {
      background: rgba(248, 81, 73, 0.18);
    }

    .hlts-default-dark .hlts-diff-row.hlts-diff-modified {
      background: rgba(210, 153, 34, 0.2);
    }

    .hlts-default-dark .hlts-diff-sign {
      width: 24px;
      text-align: center;
      color: #9da5b4;
      user-select: none;
      -webkit-user-select: none;
    }

    /* tree-sitter-ts-highlight - GitHub Light Theme */

    .hlts.hlts-github-light {
      background: #ffffff;
      color: #1f2328;
    }

    .hlts-github-light .hlts-keyword {
      color: #cf222e;
      font-weight: bold;
    }

    .hlts-github-light .hlts-identifier {
      color: #1f2328;
    }

    .hlts-github-light .hlts-string {
      color: #0a3069;
    }

    .hlts-github-light .hlts-number {
      color: #0550ae;
    }

    .hlts-github-light .hlts-comment {
      color: #6e7781;
      font-style: italic;
    }

    .hlts-github-light .hlts-operator {
      color: #1f2328;
    }

    .hlts-github-light .hlts-punctuation {
      color: #1f2328;
    }

    .hlts-github-light .hlts-type {
      color: #953800;
    }

    .hlts-github-light .hlts-decorator {
      color: #8250df;
    }

    .hlts-github-light .hlts-tag {
      color: #116329;
    }

    .hlts-github-light .hlts-attribute {
      color: #0550ae;
    }

    .hlts-github-light .hlts-meta {
      color: #6e7781;
    }

    .hlts-github-light .hlts-regexp {
      color: #0a3069;
    }

    .hlts-github-light .hlts-escape {
      color: #0550ae;
      font-weight: bold;
    }

    .hlts-github-light .hlts-variable {
      color: #953800;
    }

    .hlts-github-light .hlts-constant {
      color: #0550ae;
    }

    .hlts-github-light .hlts-error {
      color: #cf222e;
      text-decoration: wavy underline;
    }

    .hlts-github-light .hlts-plain {
      color: #1f2328;
    }

    .hlts-github-light .hlts-line-number {
      color: #8c959f;
      border-right: 1px solid #d1d9e0;
      user-select: none;
      -webkit-user-select: none;
    }

    .hlts-github-light .hlts-table {
      border-collapse: collapse;
      width: 100%;
    }

    .hlts-github-light .hlts-table tr:hover {
      background: rgba(0, 0, 0, 0.03);
    }

    /* Diff views */
    .hlts-github-light .hlts-diff {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
    }

    .hlts-github-light .hlts-diff-header .hlts-diff-label {
      text-align: left;
      font-weight: 600;
      padding: 6px 10px;
      border-bottom: 1px solid #d1d9e0;
    }

    .hlts-github-light .hlts-diff-gutter {
      color: #8c959f;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      padding: 0 10px;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-github-light .hlts-diff-content {
      white-space: pre;
      padding: 0 10px;
      vertical-align: top;
    }

    .hlts-github-light .hlts-diff-row.hlts-diff-context {
      background: transparent;
    }

    .hlts-github-light .hlts-diff-row.hlts-diff-added {
      background: rgba(46, 160, 67, 0.14);
    }

    .hlts-github-light .hlts-diff-row.hlts-diff-removed {
      background: rgba(207, 34, 46, 0.14);
    }

    .hlts-github-light .hlts-diff-row.hlts-diff-modified {
      background: rgba(191, 135, 0, 0.14);
    }

    .hlts-github-light .hlts-diff-sign {
      width: 24px;
      text-align: center;
      color: #57606a;
      user-select: none;
      -webkit-user-select: none;
    }

    /* tree-sitter-ts-highlight - GitHub Dark Theme */

    .hlts.hlts-github-dark {
      background: #0d1117;
      color: #e6edf3;
    }

    .hlts-github-dark .hlts-keyword {
      color: #ff7b72;
      font-weight: bold;
    }

    .hlts-github-dark .hlts-identifier {
      color: #e6edf3;
    }

    .hlts-github-dark .hlts-string {
      color: #a5d6ff;
    }

    .hlts-github-dark .hlts-number {
      color: #79c0ff;
    }

    .hlts-github-dark .hlts-comment {
      color: #8b949e;
      font-style: italic;
    }

    .hlts-github-dark .hlts-operator {
      color: #e6edf3;
    }

    .hlts-github-dark .hlts-punctuation {
      color: #e6edf3;
    }

    .hlts-github-dark .hlts-type {
      color: #ffa657;
    }

    .hlts-github-dark .hlts-decorator {
      color: #d2a8ff;
    }

    .hlts-github-dark .hlts-tag {
      color: #7ee787;
    }

    .hlts-github-dark .hlts-attribute {
      color: #79c0ff;
    }

    .hlts-github-dark .hlts-meta {
      color: #8b949e;
    }

    .hlts-github-dark .hlts-regexp {
      color: #a5d6ff;
    }

    .hlts-github-dark .hlts-escape {
      color: #79c0ff;
      font-weight: bold;
    }

    .hlts-github-dark .hlts-variable {
      color: #ffa657;
    }

    .hlts-github-dark .hlts-constant {
      color: #79c0ff;
    }

    .hlts-github-dark .hlts-error {
      color: #ff7b72;
      text-decoration: wavy underline;
    }

    .hlts-github-dark .hlts-plain {
      color: #e6edf3;
    }

    .hlts-github-dark .hlts-line-number {
      color: #6e7681;
      border-right: 1px solid #30363d;
      user-select: none;
      -webkit-user-select: none;
    }

    .hlts-github-dark .hlts-table {
      border-collapse: collapse;
      width: 100%;
    }

    .hlts-github-dark .hlts-table tr:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    /* Diff views */
    .hlts-github-dark .hlts-diff {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
    }

    .hlts-github-dark .hlts-diff-header .hlts-diff-label {
      text-align: left;
      font-weight: 600;
      padding: 6px 10px;
      border-bottom: 1px solid #30363d;
    }

    .hlts-github-dark .hlts-diff-gutter {
      color: #6e7681;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      padding: 0 10px;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-github-dark .hlts-diff-content {
      white-space: pre;
      padding: 0 10px;
      vertical-align: top;
    }

    .hlts-github-dark .hlts-diff-row.hlts-diff-context {
      background: transparent;
    }

    .hlts-github-dark .hlts-diff-row.hlts-diff-added {
      background: rgba(46, 160, 67, 0.2);
    }

    .hlts-github-dark .hlts-diff-row.hlts-diff-removed {
      background: rgba(248, 81, 73, 0.2);
    }

    .hlts-github-dark .hlts-diff-row.hlts-diff-modified {
      background: rgba(210, 153, 34, 0.22);
    }

    .hlts-github-dark .hlts-diff-sign {
      width: 24px;
      text-align: center;
      color: #8b949e;
      user-select: none;
      -webkit-user-select: none;
    }

    /* tree-sitter-ts-highlight - Monokai Theme */

    .hlts.hlts-monokai {
      background: #272822;
      color: #f8f8f2;
    }

    .hlts-monokai .hlts-keyword {
      color: #f92672;
      font-weight: bold;
    }

    .hlts-monokai .hlts-identifier {
      color: #f8f8f2;
    }

    .hlts-monokai .hlts-string {
      color: #e6db74;
    }

    .hlts-monokai .hlts-number {
      color: #ae81ff;
    }

    .hlts-monokai .hlts-comment {
      color: #75715e;
      font-style: italic;
    }

    .hlts-monokai .hlts-operator {
      color: #f92672;
    }

    .hlts-monokai .hlts-punctuation {
      color: #f8f8f2;
    }

    .hlts-monokai .hlts-type {
      color: #66d9ef;
      font-style: italic;
    }

    .hlts-monokai .hlts-decorator {
      color: #66d9ef;
    }

    .hlts-monokai .hlts-tag {
      color: #f92672;
    }

    .hlts-monokai .hlts-attribute {
      color: #a6e22e;
    }

    .hlts-monokai .hlts-meta {
      color: #75715e;
    }

    .hlts-monokai .hlts-regexp {
      color: #e6db74;
    }

    .hlts-monokai .hlts-escape {
      color: #ae81ff;
      font-weight: bold;
    }

    .hlts-monokai .hlts-variable {
      color: #fd971f;
    }

    .hlts-monokai .hlts-constant {
      color: #ae81ff;
    }

    .hlts-monokai .hlts-error {
      color: #f92672;
      text-decoration: wavy underline;
    }

    .hlts-monokai .hlts-plain {
      color: #f8f8f2;
    }

    .hlts-monokai .hlts-line-number {
      color: #90908a;
      border-right: 1px solid #3e3d32;
      user-select: none;
      -webkit-user-select: none;
    }

    .hlts-monokai .hlts-table {
      border-collapse: collapse;
      width: 100%;
    }

    .hlts-monokai .hlts-table tr:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    /* Diff views */
    .hlts-monokai .hlts-diff {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
    }

    .hlts-monokai .hlts-diff-header .hlts-diff-label {
      text-align: left;
      font-weight: 600;
      padding: 6px 10px;
      border-bottom: 1px solid #3e3d32;
    }

    .hlts-monokai .hlts-diff-gutter {
      color: #90908a;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      padding: 0 10px;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-monokai .hlts-diff-content {
      white-space: pre;
      padding: 0 10px;
      vertical-align: top;
    }

    .hlts-monokai .hlts-diff-row.hlts-diff-context {
      background: transparent;
    }

    .hlts-monokai .hlts-diff-row.hlts-diff-added {
      background: rgba(166, 226, 46, 0.18);
    }

    .hlts-monokai .hlts-diff-row.hlts-diff-removed {
      background: rgba(249, 38, 114, 0.2);
    }

    .hlts-monokai .hlts-diff-row.hlts-diff-modified {
      background: rgba(253, 151, 31, 0.2);
    }

    .hlts-monokai .hlts-diff-sign {
      width: 24px;
      text-align: center;
      color: #ae81ff;
      user-select: none;
      -webkit-user-select: none;
    }

    /* tree-sitter-ts-highlight - Dracula Theme */

    .hlts.hlts-dracula {
      background: #282a36;
      color: #f8f8f2;
    }

    .hlts-dracula .hlts-keyword {
      color: #ff79c6;
      font-weight: bold;
    }

    .hlts-dracula .hlts-identifier {
      color: #f8f8f2;
    }

    .hlts-dracula .hlts-string {
      color: #f1fa8c;
    }

    .hlts-dracula .hlts-number {
      color: #bd93f9;
    }

    .hlts-dracula .hlts-comment {
      color: #6272a4;
      font-style: italic;
    }

    .hlts-dracula .hlts-operator {
      color: #ff79c6;
    }

    .hlts-dracula .hlts-punctuation {
      color: #f8f8f2;
    }

    .hlts-dracula .hlts-type {
      color: #8be9fd;
      font-style: italic;
    }

    .hlts-dracula .hlts-decorator {
      color: #50fa7b;
    }

    .hlts-dracula .hlts-tag {
      color: #ff79c6;
    }

    .hlts-dracula .hlts-attribute {
      color: #50fa7b;
    }

    .hlts-dracula .hlts-meta {
      color: #6272a4;
    }

    .hlts-dracula .hlts-regexp {
      color: #f1fa8c;
    }

    .hlts-dracula .hlts-escape {
      color: #bd93f9;
      font-weight: bold;
    }

    .hlts-dracula .hlts-variable {
      color: #ffb86c;
    }

    .hlts-dracula .hlts-constant {
      color: #bd93f9;
    }

    .hlts-dracula .hlts-error {
      color: #ff5555;
      text-decoration: wavy underline;
    }

    .hlts-dracula .hlts-plain {
      color: #f8f8f2;
    }

    .hlts-dracula .hlts-line-number {
      color: #6272a4;
      border-right: 1px solid #44475a;
      user-select: none;
      -webkit-user-select: none;
    }

    .hlts-dracula .hlts-table {
      border-collapse: collapse;
      width: 100%;
    }

    .hlts-dracula .hlts-table tr:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    /* Diff views */
    .hlts-dracula .hlts-diff {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
    }

    .hlts-dracula .hlts-diff-header .hlts-diff-label {
      text-align: left;
      font-weight: 600;
      padding: 6px 10px;
      border-bottom: 1px solid #44475a;
    }

    .hlts-dracula .hlts-diff-gutter {
      color: #6272a4;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      padding: 0 10px;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-dracula .hlts-diff-content {
      white-space: pre;
      padding: 0 10px;
      vertical-align: top;
    }

    .hlts-dracula .hlts-diff-row.hlts-diff-context {
      background: transparent;
    }

    .hlts-dracula .hlts-diff-row.hlts-diff-added {
      background: rgba(80, 250, 123, 0.15);
    }

    .hlts-dracula .hlts-diff-row.hlts-diff-removed {
      background: rgba(255, 85, 85, 0.18);
    }

    .hlts-dracula .hlts-diff-row.hlts-diff-modified {
      background: rgba(255, 184, 108, 0.18);
    }

    .hlts-dracula .hlts-diff-sign {
      width: 24px;
      text-align: center;
      color: #bd93f9;
      user-select: none;
      -webkit-user-select: none;
    }

    /* tree-sitter-ts-highlight - Nord Theme */

    .hlts.hlts-nord {
      background: #2e3440;
      color: #d8dee9;
    }

    .hlts-nord .hlts-keyword {
      color: #81a1c1;
      font-weight: bold;
    }

    .hlts-nord .hlts-identifier {
      color: #d8dee9;
    }

    .hlts-nord .hlts-string {
      color: #a3be8c;
    }

    .hlts-nord .hlts-number {
      color: #b48ead;
    }

    .hlts-nord .hlts-comment {
      color: #616e88;
      font-style: italic;
    }

    .hlts-nord .hlts-operator {
      color: #81a1c1;
    }

    .hlts-nord .hlts-punctuation {
      color: #eceff4;
    }

    .hlts-nord .hlts-type {
      color: #8fbcbb;
    }

    .hlts-nord .hlts-decorator {
      color: #d08770;
    }

    .hlts-nord .hlts-tag {
      color: #81a1c1;
    }

    .hlts-nord .hlts-attribute {
      color: #8fbcbb;
    }

    .hlts-nord .hlts-meta {
      color: #616e88;
    }

    .hlts-nord .hlts-regexp {
      color: #ebcb8b;
    }

    .hlts-nord .hlts-escape {
      color: #d08770;
      font-weight: bold;
    }

    .hlts-nord .hlts-variable {
      color: #d8dee9;
    }

    .hlts-nord .hlts-constant {
      color: #b48ead;
    }

    .hlts-nord .hlts-error {
      color: #bf616a;
      text-decoration: wavy underline;
    }

    .hlts-nord .hlts-plain {
      color: #d8dee9;
    }

    .hlts-nord .hlts-line-number {
      color: #4c566a;
      border-right: 1px solid #3b4252;
      user-select: none;
      -webkit-user-select: none;
    }

    .hlts-nord .hlts-table {
      border-collapse: collapse;
      width: 100%;
    }

    .hlts-nord .hlts-table tr:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    /* Diff views */
    .hlts-nord .hlts-diff {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
    }

    .hlts-nord .hlts-diff-header .hlts-diff-label {
      text-align: left;
      font-weight: 600;
      padding: 6px 10px;
      border-bottom: 1px solid #3b4252;
    }

    .hlts-nord .hlts-diff-gutter {
      color: #4c566a;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      padding: 0 10px;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-nord .hlts-diff-content {
      white-space: pre;
      padding: 0 10px;
      vertical-align: top;
    }

    .hlts-nord .hlts-diff-row.hlts-diff-context {
      background: transparent;
    }

    .hlts-nord .hlts-diff-row.hlts-diff-added {
      background: rgba(163, 190, 140, 0.18);
    }

    .hlts-nord .hlts-diff-row.hlts-diff-removed {
      background: rgba(191, 97, 106, 0.2);
    }

    .hlts-nord .hlts-diff-row.hlts-diff-modified {
      background: rgba(235, 203, 139, 0.2);
    }

    .hlts-nord .hlts-diff-sign {
      width: 24px;
      text-align: center;
      color: #81a1c1;
      user-select: none;
      -webkit-user-select: none;
    }

    /* tree-sitter-ts-highlight - Solarized Light Theme */

    .hlts.hlts-solarized-light {
      background: #fdf6e3;
      color: #657b83;
    }

    .hlts-solarized-light .hlts-keyword {
      color: #859900;
      font-weight: bold;
    }

    .hlts-solarized-light .hlts-identifier {
      color: #657b83;
    }

    .hlts-solarized-light .hlts-string {
      color: #2aa198;
    }

    .hlts-solarized-light .hlts-number {
      color: #d33682;
    }

    .hlts-solarized-light .hlts-comment {
      color: #93a1a1;
      font-style: italic;
    }

    .hlts-solarized-light .hlts-operator {
      color: #657b83;
    }

    .hlts-solarized-light .hlts-punctuation {
      color: #657b83;
    }

    .hlts-solarized-light .hlts-type {
      color: #b58900;
    }

    .hlts-solarized-light .hlts-decorator {
      color: #6c71c4;
    }

    .hlts-solarized-light .hlts-tag {
      color: #268bd2;
    }

    .hlts-solarized-light .hlts-attribute {
      color: #b58900;
    }

    .hlts-solarized-light .hlts-meta {
      color: #93a1a1;
    }

    .hlts-solarized-light .hlts-regexp {
      color: #dc322f;
    }

    .hlts-solarized-light .hlts-escape {
      color: #cb4b16;
      font-weight: bold;
    }

    .hlts-solarized-light .hlts-variable {
      color: #268bd2;
    }

    .hlts-solarized-light .hlts-constant {
      color: #d33682;
    }

    .hlts-solarized-light .hlts-error {
      color: #dc322f;
      text-decoration: wavy underline;
    }

    .hlts-solarized-light .hlts-plain {
      color: #657b83;
    }

    .hlts-solarized-light .hlts-line-number {
      color: #93a1a1;
      border-right: 1px solid #eee8d5;
      user-select: none;
      -webkit-user-select: none;
    }

    .hlts-solarized-light .hlts-table {
      border-collapse: collapse;
      width: 100%;
    }

    .hlts-solarized-light .hlts-table tr:hover {
      background: rgba(0, 0, 0, 0.03);
    }

    /* Diff views */
    .hlts-solarized-light .hlts-diff {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
    }

    .hlts-solarized-light .hlts-diff-header .hlts-diff-label {
      text-align: left;
      font-weight: 600;
      padding: 6px 10px;
      border-bottom: 1px solid #eee8d5;
    }

    .hlts-solarized-light .hlts-diff-gutter {
      color: #93a1a1;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      padding: 0 10px;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-solarized-light .hlts-diff-content {
      white-space: pre;
      padding: 0 10px;
      vertical-align: top;
    }

    .hlts-solarized-light .hlts-diff-row.hlts-diff-context {
      background: transparent;
    }

    .hlts-solarized-light .hlts-diff-row.hlts-diff-added {
      background: rgba(133, 153, 0, 0.16);
    }

    .hlts-solarized-light .hlts-diff-row.hlts-diff-removed {
      background: rgba(220, 50, 47, 0.16);
    }

    .hlts-solarized-light .hlts-diff-row.hlts-diff-modified {
      background: rgba(181, 137, 0, 0.16);
    }

    .hlts-solarized-light .hlts-diff-sign {
      width: 24px;
      text-align: center;
      color: #586e75;
      user-select: none;
      -webkit-user-select: none;
    }

    /* tree-sitter-ts-highlight - Solarized Dark Theme */

    .hlts.hlts-solarized-dark {
      background: #002b36;
      color: #839496;
    }

    .hlts-solarized-dark .hlts-keyword {
      color: #859900;
      font-weight: bold;
    }

    .hlts-solarized-dark .hlts-identifier {
      color: #839496;
    }

    .hlts-solarized-dark .hlts-string {
      color: #2aa198;
    }

    .hlts-solarized-dark .hlts-number {
      color: #d33682;
    }

    .hlts-solarized-dark .hlts-comment {
      color: #586e75;
      font-style: italic;
    }

    .hlts-solarized-dark .hlts-operator {
      color: #839496;
    }

    .hlts-solarized-dark .hlts-punctuation {
      color: #839496;
    }

    .hlts-solarized-dark .hlts-type {
      color: #b58900;
    }

    .hlts-solarized-dark .hlts-decorator {
      color: #6c71c4;
    }

    .hlts-solarized-dark .hlts-tag {
      color: #268bd2;
    }

    .hlts-solarized-dark .hlts-attribute {
      color: #b58900;
    }

    .hlts-solarized-dark .hlts-meta {
      color: #586e75;
    }

    .hlts-solarized-dark .hlts-regexp {
      color: #dc322f;
    }

    .hlts-solarized-dark .hlts-escape {
      color: #cb4b16;
      font-weight: bold;
    }

    .hlts-solarized-dark .hlts-variable {
      color: #268bd2;
    }

    .hlts-solarized-dark .hlts-constant {
      color: #d33682;
    }

    .hlts-solarized-dark .hlts-error {
      color: #dc322f;
      text-decoration: wavy underline;
    }

    .hlts-solarized-dark .hlts-plain {
      color: #839496;
    }

    .hlts-solarized-dark .hlts-line-number {
      color: #586e75;
      border-right: 1px solid #073642;
      user-select: none;
      -webkit-user-select: none;
    }

    .hlts-solarized-dark .hlts-table {
      border-collapse: collapse;
      width: 100%;
    }

    .hlts-solarized-dark .hlts-table tr:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    /* Diff views */
    .hlts-solarized-dark .hlts-diff {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
    }

    .hlts-solarized-dark .hlts-diff-header .hlts-diff-label {
      text-align: left;
      font-weight: 600;
      padding: 6px 10px;
      border-bottom: 1px solid #073642;
    }

    .hlts-solarized-dark .hlts-diff-gutter {
      color: #586e75;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      padding: 0 10px;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-solarized-dark .hlts-diff-content {
      white-space: pre;
      padding: 0 10px;
      vertical-align: top;
    }

    .hlts-solarized-dark .hlts-diff-row.hlts-diff-context {
      background: transparent;
    }

    .hlts-solarized-dark .hlts-diff-row.hlts-diff-added {
      background: rgba(133, 153, 0, 0.2);
    }

    .hlts-solarized-dark .hlts-diff-row.hlts-diff-removed {
      background: rgba(220, 50, 47, 0.2);
    }

    .hlts-solarized-dark .hlts-diff-row.hlts-diff-modified {
      background: rgba(181, 137, 0, 0.22);
    }

    .hlts-solarized-dark .hlts-diff-sign {
      width: 24px;
      text-align: center;
      color: #93a1a1;
      user-select: none;
      -webkit-user-select: none;
    }

    /* tree-sitter-ts-highlight - Tokyo Night Theme */

    .hlts.hlts-tokyo-night {
      background: #1a1b26;
      color: #a9b1d6;
    }

    .hlts-tokyo-night .hlts-keyword {
      color: #9d7cd8;
      font-weight: bold;
    }

    .hlts-tokyo-night .hlts-identifier {
      color: #c0caf5;
    }

    .hlts-tokyo-night .hlts-string {
      color: #9ece6a;
    }

    .hlts-tokyo-night .hlts-number {
      color: #ff9e64;
    }

    .hlts-tokyo-night .hlts-comment {
      color: #565f89;
      font-style: italic;
    }

    .hlts-tokyo-night .hlts-operator {
      color: #89ddff;
    }

    .hlts-tokyo-night .hlts-punctuation {
      color: #a9b1d6;
    }

    .hlts-tokyo-night .hlts-type {
      color: #2ac3de;
    }

    .hlts-tokyo-night .hlts-decorator {
      color: #bb9af7;
    }

    .hlts-tokyo-night .hlts-tag {
      color: #f7768e;
    }

    .hlts-tokyo-night .hlts-attribute {
      color: #73daca;
    }

    .hlts-tokyo-night .hlts-meta {
      color: #565f89;
    }

    .hlts-tokyo-night .hlts-regexp {
      color: #b4f9f8;
    }

    .hlts-tokyo-night .hlts-escape {
      color: #ff9e64;
      font-weight: bold;
    }

    .hlts-tokyo-night .hlts-variable {
      color: #7dcfff;
    }

    .hlts-tokyo-night .hlts-constant {
      color: #ff9e64;
    }

    .hlts-tokyo-night .hlts-error {
      color: #f7768e;
      text-decoration: wavy underline;
    }

    .hlts-tokyo-night .hlts-plain {
      color: #a9b1d6;
    }

    .hlts-tokyo-night .hlts-line-number {
      color: #3b4261;
      border-right: 1px solid #292e42;
      user-select: none;
      -webkit-user-select: none;
    }

    .hlts-tokyo-night .hlts-table {
      border-collapse: collapse;
      width: 100%;
    }

    .hlts-tokyo-night .hlts-table tr:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    /* Diff views */
    .hlts-tokyo-night .hlts-diff {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
    }

    .hlts-tokyo-night .hlts-diff-header .hlts-diff-label {
      text-align: left;
      font-weight: 600;
      padding: 6px 10px;
      border-bottom: 1px solid #292e42;
    }

    .hlts-tokyo-night .hlts-diff-gutter {
      color: #3b4261;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      padding: 0 10px;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-tokyo-night .hlts-diff-content {
      white-space: pre;
      padding: 0 10px;
      vertical-align: top;
    }

    .hlts-tokyo-night .hlts-diff-row.hlts-diff-context {
      background: transparent;
    }

    .hlts-tokyo-night .hlts-diff-row.hlts-diff-added {
      background: rgba(158, 206, 106, 0.2);
    }

    .hlts-tokyo-night .hlts-diff-row.hlts-diff-removed {
      background: rgba(247, 118, 142, 0.2);
    }

    .hlts-tokyo-night .hlts-diff-row.hlts-diff-modified {
      background: rgba(255, 158, 100, 0.22);
    }

    .hlts-tokyo-night .hlts-diff-sign {
      width: 24px;
      text-align: center;
      color: #7aa2f7;
      user-select: none;
      -webkit-user-select: none;
    }

    /* tree-sitter-ts-highlight - Catppuccin Mocha Theme */

    .hlts.hlts-catppuccin-mocha {
      background: #1e1e2e;
      color: #cdd6f4;
    }

    .hlts-catppuccin-mocha .hlts-keyword {
      color: #cba6f7;
      font-weight: bold;
    }

    .hlts-catppuccin-mocha .hlts-identifier {
      color: #cdd6f4;
    }

    .hlts-catppuccin-mocha .hlts-string {
      color: #a6e3a1;
    }

    .hlts-catppuccin-mocha .hlts-number {
      color: #fab387;
    }

    .hlts-catppuccin-mocha .hlts-comment {
      color: #6c7086;
      font-style: italic;
    }

    .hlts-catppuccin-mocha .hlts-operator {
      color: #89dceb;
    }

    .hlts-catppuccin-mocha .hlts-punctuation {
      color: #9399b2;
    }

    .hlts-catppuccin-mocha .hlts-type {
      color: #f9e2af;
    }

    .hlts-catppuccin-mocha .hlts-decorator {
      color: #f5c2e7;
    }

    .hlts-catppuccin-mocha .hlts-tag {
      color: #89b4fa;
    }

    .hlts-catppuccin-mocha .hlts-attribute {
      color: #f2cdcd;
    }

    .hlts-catppuccin-mocha .hlts-meta {
      color: #6c7086;
    }

    .hlts-catppuccin-mocha .hlts-regexp {
      color: #f5c2e7;
    }

    .hlts-catppuccin-mocha .hlts-escape {
      color: #fab387;
      font-weight: bold;
    }

    .hlts-catppuccin-mocha .hlts-variable {
      color: #f38ba8;
    }

    .hlts-catppuccin-mocha .hlts-constant {
      color: #fab387;
    }

    .hlts-catppuccin-mocha .hlts-error {
      color: #f38ba8;
      text-decoration: wavy underline;
    }

    .hlts-catppuccin-mocha .hlts-plain {
      color: #cdd6f4;
    }

    .hlts-catppuccin-mocha .hlts-line-number {
      color: #585b70;
      border-right: 1px solid #313244;
      user-select: none;
      -webkit-user-select: none;
    }

    .hlts-catppuccin-mocha .hlts-table {
      border-collapse: collapse;
      width: 100%;
    }

    .hlts-catppuccin-mocha .hlts-table tr:hover {
      background: rgba(255, 255, 255, 0.03);
    }

    /* Diff views */
    .hlts-catppuccin-mocha .hlts-diff {
      border-collapse: collapse;
      width: 100%;
      table-layout: auto;
    }

    .hlts-catppuccin-mocha .hlts-diff-header .hlts-diff-label {
      text-align: left;
      font-weight: 600;
      padding: 6px 10px;
      border-bottom: 1px solid #313244;
    }

    .hlts-catppuccin-mocha .hlts-diff-gutter {
      color: #585b70;
      text-align: right;
      user-select: none;
      -webkit-user-select: none;
      width: 1%;
      padding: 0 10px;
      vertical-align: top;
      white-space: nowrap;
    }

    .hlts-catppuccin-mocha .hlts-diff-content {
      white-space: pre;
      padding: 0 10px;
      vertical-align: top;
    }

    .hlts-catppuccin-mocha .hlts-diff-row.hlts-diff-context {
      background: transparent;
    }

    .hlts-catppuccin-mocha .hlts-diff-row.hlts-diff-added {
      background: rgba(166, 227, 161, 0.2);
    }

    .hlts-catppuccin-mocha .hlts-diff-row.hlts-diff-removed {
      background: rgba(243, 139, 168, 0.22);
    }

    .hlts-catppuccin-mocha .hlts-diff-row.hlts-diff-modified {
      background: rgba(250, 179, 135, 0.22);
    }

    .hlts-catppuccin-mocha .hlts-diff-sign {
      width: 24px;
      text-align: center;
      color: #89b4fa;
      user-select: none;
      -webkit-user-select: none;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="hero">
      <div>
        <h1>tree-sitter-ts-highlight</h1>
        <p class="subtitle">Interactive demos for parser-based syntax highlighting, semantic rendering, and diff
          exploration.</p>
      </div>
    </div>

    <div class="panel">
      <div class="controls">
        <div>
          <label for="language">Language</label>
          <select id="language"></select>
        </div>
        <div>
          <label for="theme">Theme</label>
          <select id="theme"></select>
        </div>
        <div>
          <label>&nbsp;</label>
          <button id="renderBtn" type="button">Render</button>
        </div>
      </div>
      <div class="row" style="margin-top:12px">
        <label class="check"><input id="semantic" type="checkbox" checked /> Semantic highlighting</label>
        <label class="check"><input id="lineNumbers" type="checkbox" checked /> Line numbers</label>
        <label class="check"><input id="symbolFold" type="checkbox" checked /> Symbol fold arrows</label>
        <label class="check"><input id="customInput" type="checkbox" /> Use custom input</label>
        <button id="dslBtn" type="button">Register custom DSL profile</button>
      </div>
    </div>

    <nav class="tab-nav" aria-label="Demo sections">
      <button class="tab-btn active" type="button" data-view-target="playground">Highlight Playground</button>
      <button class="tab-btn" type="button" data-view-target="diff">Diff Explorer</button>
    </nav>

    <section class="view active" id="view-playground" data-view="playground">
      <div class="panel">
        <label for="source">Source code</label>
        <textarea id="source"></textarea>
      </div>

      <div class="panel code-wrap">
        <h2>Live Highlight Output</h2>
        <div id="preview"></div>
      </div>

      <div class="grid-2">
        <div class="panel code-wrap">
          <h2>Comparison: semantic OFF</h2>
          <div id="previewOff"></div>
        </div>
        <div class="panel code-wrap">
          <h2>Comparison: semantic ON</h2>
          <div id="previewOn"></div>
        </div>
      </div>

      <div class="panel">
        <h2>Extracted Symbols</h2>
        <p class="muted">Live output from <strong>extractSymbols(source, language)</strong> for the current code.</p>
        <table class="symbols-table">
          <thead>
            <tr>
              <th>Kind</th>
              <th>Name</th>
              <th>Name Range</th>
              <th>Content Range</th>
            </tr>
          </thead>
          <tbody id="symbolsBody"></tbody>
        </table>
      </div>
    </section>

    <section class="view" id="view-diff" data-view="diff">
      <div class="panel">
        <h2>Diff Explorer</h2>
        <p class="muted">Compare two source versions using <strong>side-by-side</strong> or <strong>inline</strong>
          mode, and inspect the wrapper-friendly <strong>diffModel()</strong> output.</p>
        <div class="controls" style="margin-bottom:12px">
          <div>
            <label for="diffView">Diff view</label>
            <select id="diffView">
              <option value="side-by-side">Side by side</option>
              <option value="inline">Inline</option>
            </select>
          </div>
        </div>
        <div class="grid-2" style="margin-bottom:12px">
          <div>
            <label for="diffOld">Original source</label>
            <textarea id="diffOld"></textarea>
          </div>
          <div>
            <label for="diffNew">Updated source</label>
            <textarea id="diffNew"></textarea>
          </div>
        </div>
        <div class="diff-preview" id="diffPreview"></div>
        <h2 style="margin-top:16px">Diff Model (for wrappers)</h2>
        <pre class="json-preview" id="diffModelPreview"></pre>
      </div>
    </section>

  </div>

  <script type="module">
    let demoApi;
    try {
      const [highlightMod, parserMod] = await Promise.all([
        import("tree-sitter-ts-highlight"),
        import("tree-sitter-ts"),
      ]);

      demoApi = {
        builtinThemes: highlightMod.builtinThemes,
        highlight: highlightMod.highlight,
        highlightDiff: highlightMod.highlightDiff,
        diffModel: highlightMod.diffModel,
        decorateLineTableWithSymbolBlocks: highlightMod.decorateLineTableWithSymbolBlocks,
        extractSymbols: parserMod.extractSymbols,
        registerProfile: parserMod.registerProfile,
      };

    } catch (error) {
      throw error;
    }

    const { builtinThemes, highlight, highlightDiff, diffModel, decorateLineTableWithSymbolBlocks, extractSymbols, registerProfile } = demoApi;

    const samples = { "typescript": { "label": "TypeScript", "code": "import { readFile } from \"node:fs/promises\";\n\ninterface Config {\n  port: number;\n  host: string;\n  debug?: boolean;\n}\n\nexport class Server {\n  constructor(private config: Config) {}\n\n  start(): void {\n    const { host, port } = this.config;\n    console.log(\"Server running at \" + host + \":\" + port);\n  }\n}\n\nexport function createServer(port = 3000): Server {\n  return new Server({ port, host: \"localhost\", debug: true });\n}" }, "javascript": { "label": "JavaScript", "code": "const users = [\n  { name: \"Ada\", age: 31 },\n  { name: \"Lin\", age: 17 },\n];\n\nfunction getAdults(list) {\n  return list.filter((item) => item.age >= 18).map((item) => item.name);\n}\n\nconsole.log(getAdults(users));" }, "python": { "label": "Python", "code": "from dataclasses import dataclass\n\n@dataclass\nclass User:\n    name: str\n    active: bool = True\n\n\ndef greet(user: User) -> str:\n    if user.active:\n        return f\"Hello, {user.name}!\"\n    return \"Inactive user\"" }, "go": { "label": "Go", "code": "package main\n\nimport \"fmt\"\n\ntype User struct {\n    Name string\n    Age  int\n}\n\nfunc main() {\n    user := User{Name: \"Go\", Age: 16}\n    fmt.Println(user)\n}" }, "rust": { "label": "Rust", "code": "struct User {\n    name: String,\n    age: u32,\n}\n\nfn main() {\n    let user = User { name: String::from(\"Rust\"), age: 8 };\n    println!(\"{} {}\", user.name, user.age);\n}" }, "java": { "label": "Java", "code": "public class Main {\n  static class User {\n    String name;\n    int age;\n\n    User(String name, int age) {\n      this.name = name;\n      this.age = age;\n    }\n  }\n\n  public static void main(String[] args) {\n    User user = new User(\"Java\", 30);\n    System.out.println(user.name + \" \" + user.age);\n  }\n}" }, "csharp": { "label": "C#", "code": "using System;\n\nrecord User(string Name, int Age);\n\nvar user = new User(\"CSharp\", 20);\nConsole.WriteLine($\"{user.Name} {user.Age}\");" }, "cpp": { "label": "C++", "code": "#include <iostream>\n\nclass User {\npublic:\n  std::string name;\n  int age;\n\n  User(std::string n, int a) : name(n), age(a) {}\n};\n\nint main() {\n  User user(\"CPP\", 40);\n  std::cout << user.name << \" \" << user.age << std::endl;\n}" }, "ruby": { "label": "Ruby", "code": "class User\n  attr_reader :name, :age\n\n  def initialize(name, age)\n    @name = name\n    @age = age\n  end\nend\n\nuser = User.new(\"Ruby\", 28)\nputs \"#{user.name} #{user.age}\"" }, "php": { "label": "PHP", "code": "<?php\nclass User {\n  public function __construct(\n    public string $name,\n    public int $age\n  ) {}\n}\n\n$user = new User(\"PHP\", 23);\necho $user->name . \" \" . $user->age;" }, "kotlin": { "label": "Kotlin", "code": "data class User(val name: String, val age: Int)\n\nfun main() {\n    val user = User(\"Kotlin\", 12)\n    println(\"${user.name} ${user.age}\")\n}" }, "swift": { "label": "Swift", "code": "struct User {\n    let name: String\n    let age: Int\n}\n\nlet user = User(name: \"Swift\", age: 11)\nprint(\"(user.name) (user.age)\")" }, "css": { "label": "CSS", "code": ":root {\n  --accent: #7aa2f7;\n}\n\n.card {\n  color: var(--accent);\n  border: 1px solid #2a2a3a;\n}" }, "html": { "label": "HTML", "code": "<section class=\"card\">\n  <h1>Demo</h1>\n  <p data-id=\"42\">Hello</p>\n</section>" }, "json": { "label": "JSON", "code": "{\n  \"name\": \"json-demo\",\n  \"enabled\": true,\n  \"ports\": [3000, 3001],\n  \"meta\": { \"owner\": \"team\" }\n}" }, "yaml": { "label": "YAML", "code": "name: yaml-demo\nenabled: true\nports:\n  - 3000\n  - 3001\nmeta:\n  owner: team" }, "sql": { "label": "SQL", "code": "SELECT id, name\nFROM users\nWHERE active = true\nORDER BY created_at DESC\nLIMIT 10;" }, "shell": { "label": "Shell", "code": "#!/usr/bin/env bash\nset -euo pipefail\n\nname=\"demo\"\necho \"running $name\"" }, "markdown": { "label": "Markdown", "code": "# Demo\n\n- **Bold** item\n- Inline code: `npm run build`\n\n> Quote" }, "xml": { "label": "XML", "code": "<users>\n  <user id=\"1\" active=\"true\">Alice</user>\n  <user id=\"2\" active=\"false\">Bob</user>\n</users>" }, "toml": { "label": "TOML", "code": "# TOML demo config\ntitle = \"tree-sitter-ts-highlight\"\nenabled = true\ntimeout = 30\npi = 3.14159\nhosts = [\"alpha\", \"beta\"]\n\n[database]\nserver = \"192.168.1.1\"\nports = [8001, 8001, 8002]\nconnection_max = 5000\n\n[owner]\nname = \"Tom Preston-Werner\"\ndob = 1979-05-27T07:32:00Z" } };
    const defaultThemeNames = ["default-light", "default-dark", "github-light", "github-dark", "monokai", "dracula", "nord", "solarized-light", "solarized-dark", "tokyo-night", "catppuccin-mocha"];

    const languageSelect = document.getElementById("language");
    const themeSelect = document.getElementById("theme");
    const sourceArea = document.getElementById("source");
    const renderBtn = document.getElementById("renderBtn");
    const semanticInput = document.getElementById("semantic");
    const lineNumbersInput = document.getElementById("lineNumbers");
    const symbolFoldInput = document.getElementById("symbolFold");
    const customInput = document.getElementById("customInput");
    const dslBtn = document.getElementById("dslBtn");
    const diffView = document.getElementById("diffView");
    const diffOld = document.getElementById("diffOld");
    const diffNew = document.getElementById("diffNew");

    const preview = document.getElementById("preview");
    const previewOff = document.getElementById("previewOff");
    const previewOn = document.getElementById("previewOn");
    const symbolsBody = document.getElementById("symbolsBody");
    const diffPreview = document.getElementById("diffPreview");
    const diffModelPreview = document.getElementById("diffModelPreview");
    const tabButtons = Array.from(document.querySelectorAll("[data-view-target]"));
    const viewSections = Array.from(document.querySelectorAll("[data-view]"));

    const themeMap = new Map(builtinThemes.map((theme) => [theme.name, theme]));
    const autoThemeByScheme = {
      light: "github-light",
      dark: "github-dark",
    };
    const colorSchemeMedia =
      typeof window !== "undefined" && typeof window.matchMedia === "function"
        ? window.matchMedia("(prefers-color-scheme: dark)")
        : null;
    let themeChangedManually = false;

    const dslCode = "# Pipeline DSL sample\npipeline deploy {\n  stage build {\n    step compile\n    step test\n  }\n\n  stage release {\n    when env.TARGET = \"prod\"\n    step publish\n  }\n}";
    const dslProfile = { "name": "pipeline-dsl", "displayName": "Pipeline DSL", "version": "1.0.0", "fileExtensions": [".pipe"], "lexer": { "charClasses": { "identStart": { "union": [{ "predefined": "letter" }, { "chars": "_" }] }, "identPart": { "union": [{ "predefined": "alphanumeric" }, { "chars": "_-" }] } }, "tokenTypes": { "keyword": { "category": "keyword" }, "identifier": { "category": "identifier" }, "string": { "category": "string" }, "number": { "category": "number" }, "comment": { "category": "comment" }, "operator": { "category": "operator" }, "punctuation": { "category": "punctuation" }, "type": { "category": "type" }, "whitespace": { "category": "whitespace" }, "newline": { "category": "newline" } }, "initialState": "default", "skipTokens": ["whitespace", "newline"], "states": { "default": { "rules": [{ "match": { "kind": "keywords", "words": ["pipeline", "stage", "step", "when", "env"] }, "token": "keyword" }, { "match": { "kind": "keywords", "words": ["String", "Number", "Boolean", "File"] }, "token": "type" }, { "match": { "kind": "line", "start": "#" }, "token": "comment" }, { "match": { "kind": "delimited", "open": "\"", "close": "\"", "escape": "\\" }, "token": "string" }, { "match": { "kind": "number", "integer": true, "float": true }, "token": "number" }, { "match": { "kind": "string", "value": ["->", "=>", "|", "="] }, "token": "operator" }, { "match": { "kind": "string", "value": ["{", "}", "(", ")", "[", "]", ",", ":", ";", "."] }, "token": "punctuation" }, { "match": { "kind": "charSequence", "first": { "ref": "identStart" }, "rest": { "ref": "identPart" } }, "token": "identifier" }, { "match": { "kind": "charSequence", "first": { "predefined": "whitespace" }, "rest": { "predefined": "whitespace" } }, "token": "whitespace" }, { "match": { "kind": "string", "value": "\n" }, "token": "newline" }] } } } };
    const diffSamples = {
      typescript: {
        oldSource: 'interface User {\n  id: number;\n  name: string;\n}\n\nexport function formatUser(user: User): string {\n  return user.name;\n}',
        newSource: 'interface User {\n  id: number;\n  name: string;\n  email?: string;\n}\n\nexport function formatUser(user: User): string {\n  return user.name + " <" + (user.email ?? "n/a") + ">";\n}',
      },
      javascript: {
        oldSource: 'function sum(items) {\n  return items.reduce((acc, item) => acc + item, 0);\n}',
        newSource: 'export function sum(items) {\n  if (!Array.isArray(items)) return 0;\n  return items.reduce((acc, item) => acc + item, 0);\n}',
      },
      python: {
        oldSource: 'def greet(name):\n    return "Hello " + name',
        newSource: 'def greet(name: str) -> str:\n    if not name:\n        return "Hello"\n    return f"Hello {name}"',
      },
    };

    function fillLanguages() {
      const entries = Object.entries(samples);
      languageSelect.innerHTML = entries
        .map(([id, item]) => '<option value="' + id + '">' + item.label + '</option>')
        .join("");
    }

    function fillThemes() {
      themeSelect.innerHTML = defaultThemeNames
        .map((name) => '<option value="' + name + '">' + name + '</option>')
        .join("");
    }

    function getPreferredThemeName() {
      const isDark = colorSchemeMedia ? colorSchemeMedia.matches : false;
      const preferred = isDark ? autoThemeByScheme.dark : autoThemeByScheme.light;
      return defaultThemeNames.includes(preferred) ? preferred : defaultThemeNames[0];
    }

    function syncCodeThemeWithPage(force) {
      if (!force && themeChangedManually) {
        return;
      }
      themeSelect.value = getPreferredThemeName();
    }

    function currentViewFromHash() {
      const hash = (window.location.hash || "").replace(/^#/, "");
      if (hash === "diff" || hash === "playground") {
        return hash;
      }
      return "playground";
    }

    function setActiveView(viewName, updateHash) {
      viewSections.forEach((section) => {
        const isActive = section.getAttribute("data-view") === viewName;
        section.classList.toggle("active", isActive);
      });

      tabButtons.forEach((button) => {
        const isActive = button.getAttribute("data-view-target") === viewName;
        button.classList.toggle("active", isActive);
        button.setAttribute("aria-current", isActive ? "page" : "false");
      });

      if (updateHash && window.location.hash !== "#" + viewName) {
        window.location.hash = viewName;
      }
    }

    function getSelectedCode() {
      const lang = languageSelect.value;
      if (customInput.checked) return sourceArea.value;
      return samples[lang] ? samples[lang].code : "";
    }

    function setSourceFromLanguage() {
      if (!customInput.checked) {
        sourceArea.value = samples[languageSelect.value] ? samples[languageSelect.value].code : "";
      }
    }

    function renderCode(html, theme) {
      const themeClass = theme && theme.name ? ' hlts-' + theme.name : '';
      return '<pre class="hlts' + themeClass + '"><code>' + html + '</code></pre>';
    }

    function escapeHtml(value) {
      return String(value)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#39;");
    }

    function setDiffFromLanguage() {
      const language = languageSelect.value;
      const sample = diffSamples[language] || {
        oldSource: (samples[language] ? samples[language].code : "").split("\n").slice(0, 12).join("\n"),
        newSource: (samples[language] ? samples[language].code : "").split("\n").slice(0, 12).join("\n") + "\n",
      };
      diffOld.value = sample.oldSource;
      diffNew.value = sample.newSource;
    }

    function renderDiff(language, theme) {
      const oldSource = diffOld.value;
      const newSource = diffNew.value;
      try {
        const html = highlightDiff(oldSource, newSource, language, {
          view: diffView.value,
          semanticHighlighting: semanticInput.checked,
        });
        const themeClass = theme && theme.name ? ' hlts-' + theme.name : '';
        diffPreview.innerHTML = '<div class="hlts' + themeClass + '">' + html + '</div>';

        const model = diffModel(oldSource, newSource, {
          oldLabel: "Original",
          newLabel: "Updated",
        });
        const compact = {
          oldLabel: model.oldLabel,
          newLabel: model.newLabel,
          totalRows: model.rows.length,
          rows: model.rows.slice(0, 12),
        };
        diffModelPreview.innerHTML = escapeHtml(JSON.stringify(compact, null, 2));
      } catch (error) {
        diffPreview.innerHTML = '<pre class="hlts" style="background:#2b1d24;color:#ffb4c1"><code>' + escapeHtml(String(error)) + '</code></pre>';
        diffModelPreview.textContent = String(error);
      }
    }

    function formatRange(range, fallbackStartLine, fallbackEndLine) {
      if (!range || !range.start || !range.end) {
        if (typeof fallbackStartLine === "number" || typeof fallbackEndLine === "number") {
          const start = typeof fallbackStartLine === "number" ? fallbackStartLine : "-";
          const end = typeof fallbackEndLine === "number" ? fallbackEndLine : start;
          return start + " â†’ " + end;
        }
        return "-";
      }

      const start = range.start.line + ":" + range.start.column;
      const end = range.end.line + ":" + range.end.column;
      return start + " â†’ " + end;
    }

    function applySymbolBlocks(html, symbols, withLineNumbers) {
      if (!withLineNumbers) return html;
      if (!symbolFoldInput.checked) return html;
      if (typeof decorateLineTableWithSymbolBlocks !== "function") return html;

      return decorateLineTableWithSymbolBlocks(html, symbols, {
        showFoldArrows: symbolFoldInput.checked,
      });
    }

    function parseFoldIds(value) {
      return String(value || "")
        .split(",")
        .map((part) => part.trim())
        .filter(Boolean);
    }

    function setupSymbolFolding() {
      document.addEventListener("click", (event) => {
        const target = event.target;
        if (!target || typeof target.closest !== "function") return;
        const button = target.closest("[data-hlts-fold-toggle]");
        if (!button) return;

        const table = button.closest("table");
        if (!table) return;

        const toggleIds = parseFoldIds(button.getAttribute("data-hlts-fold-toggle"));
        if (!toggleIds.length) return;

        const collapsedAttr = table.getAttribute("data-hlts-collapsed") || "";
        const collapsed = new Set(parseFoldIds(collapsedAttr));
        const shouldCollapse = !toggleIds.some((id) => collapsed.has(id));

        for (const id of toggleIds) {
          if (shouldCollapse) {
            collapsed.add(id);
          } else {
            collapsed.delete(id);
          }
        }

        table.setAttribute("data-hlts-collapsed", Array.from(collapsed).join(","));

        const rows = table.querySelectorAll("tr[data-hlts-fold-members]");
        rows.forEach((row) => {
          const members = parseFoldIds(row.getAttribute("data-hlts-fold-members"));
          const hide = members.some((id) => collapsed.has(id));
          row.style.display = hide ? "none" : "";
        });

        const buttons = table.querySelectorAll("[data-hlts-fold-toggle]");
        buttons.forEach((btn) => {
          const ids = parseFoldIds(btn.getAttribute("data-hlts-fold-toggle"));
          const isCollapsed = ids.some((id) => collapsed.has(id));
          btn.setAttribute("aria-expanded", isCollapsed ? "false" : "true");
          btn.textContent = isCollapsed ? "â–¸" : "â–¾";
        });
      });
    }

    function renderSymbols(source, language) {
      try {
        const symbols = extractSymbols(source, language);
        if (!symbols.length) {
          symbolsBody.innerHTML = '<tr><td colspan="4" class="muted">No symbols extracted for this sample.</td></tr>';
          return;
        }

        symbolsBody.innerHTML = symbols
          .slice(0, 24)
          .map((symbol) =>
            '<tr><td>' + symbol.kind + '</td><td>' + symbol.name + '</td><td>' + formatRange(symbol.nameRange, symbol.startLine, symbol.startLine) + '</td><td>' + formatRange(symbol.contentRange, symbol.startLine, symbol.endLine) + '</td></tr>'
          )
          .join("");
      } catch (error) {
        symbolsBody.innerHTML = '<tr><td colspan="4" class="muted">Symbol extraction is unavailable: ' + String(error) + '</td></tr>';
      }
    }

    function renderAll() {
      const language = languageSelect.value;
      const source = getSelectedCode();
      const theme = themeMap.get(themeSelect.value) || builtinThemes[0];
      const withLineNumbers = lineNumbersInput.checked;
      const symbols = (() => {
        try {
          return extractSymbols(source, language);
        } catch {
          return [];
        }
      })();

      try {
        const selectedHtmlRaw = highlight(source, language, {
          lineNumbers: withLineNumbers,
          semanticHighlighting: semanticInput.checked,
        });
        const baseHtmlRaw = highlight(source, language, {
          lineNumbers: withLineNumbers,
          semanticHighlighting: false,
        });
        const semanticHtmlRaw = highlight(source, language, {
          lineNumbers: withLineNumbers,
          semanticHighlighting: true,
        });

        const selectedHtml = applySymbolBlocks(selectedHtmlRaw, symbols, withLineNumbers);
        const baseHtml = applySymbolBlocks(baseHtmlRaw, symbols, withLineNumbers);
        const semanticHtml = applySymbolBlocks(semanticHtmlRaw, symbols, withLineNumbers);

        preview.innerHTML = renderCode(selectedHtml, theme);
        previewOff.innerHTML = renderCode(baseHtml, theme);
        previewOn.innerHTML = renderCode(semanticHtml, theme);
      } catch (error) {
        const message = String(error);
        preview.innerHTML = '<pre class="hlts" style="background:#2b1d24;color:#ffb4c1"><code>' + message + '</code></pre>';
        previewOff.innerHTML = "";
        previewOn.innerHTML = "";
      }

      renderSymbols(source, language);
      renderDiff(language, theme);
    }

    dslBtn.addEventListener("click", () => {
      if (!samples["pipeline-dsl"]) {
        registerProfile(dslProfile);
        samples["pipeline-dsl"] = { label: "Pipeline DSL (custom)", code: dslCode };
        fillLanguages();
        languageSelect.value = "pipeline-dsl";
        customInput.checked = false;
        setSourceFromLanguage();
        setDiffFromLanguage();
        renderAll();
      }
    });

    renderBtn.addEventListener("click", renderAll);
    languageSelect.addEventListener("change", () => {
      setSourceFromLanguage();
      setDiffFromLanguage();
      renderAll();
    });
    themeSelect.addEventListener("change", () => {
      themeChangedManually = true;
      renderAll();
    });
    semanticInput.addEventListener("change", renderAll);
    lineNumbersInput.addEventListener("change", renderAll);
    symbolFoldInput.addEventListener("change", renderAll);
    diffView.addEventListener("change", renderAll);
    diffOld.addEventListener("input", renderAll);
    diffNew.addEventListener("input", renderAll);
    customInput.addEventListener("change", () => {
      if (!customInput.checked) {
        setSourceFromLanguage();
      }
      sourceArea.readOnly = !customInput.checked;
      renderAll();
    });
    sourceArea.addEventListener("input", () => {
      if (customInput.checked) {
        renderAll();
      }
    });

    tabButtons.forEach((button) => {
      button.addEventListener("click", () => {
        const target = button.getAttribute("data-view-target");
        if (target) {
          setActiveView(target, true);
        }
      });
    });

    window.addEventListener("hashchange", () => {
      setActiveView(currentViewFromHash(), false);
    });

    if (colorSchemeMedia) {
      const onSchemeChange = () => {
        if (!themeChangedManually) {
          syncCodeThemeWithPage(false);
          renderAll();
        }
      };
      if (typeof colorSchemeMedia.addEventListener === "function") {
        colorSchemeMedia.addEventListener("change", onSchemeChange);
      } else if (typeof colorSchemeMedia.addListener === "function") {
        colorSchemeMedia.addListener(onSchemeChange);
      }
    }

    fillLanguages();
    fillThemes();
    setupSymbolFolding();
    syncCodeThemeWithPage(true);
    languageSelect.value = "typescript";
    sourceArea.readOnly = true;
    setSourceFromLanguage();
    setDiffFromLanguage();
    setActiveView(currentViewFromHash(), false);
    renderAll();
  </script>
</body>

</html>